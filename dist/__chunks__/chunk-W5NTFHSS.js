import{a as x}from"./chunk-4MBWSVL5.js";import{a as S}from"./chunk-UQ4TKO4K.js";import{a as P}from"./chunk-XUD3HGD3.js";import{a as v}from"./chunk-K3GCLKZ7.js";import{c as E}from"./chunk-JUB6TCFX.js";import{a as R}from"./chunk-R4M6QQ4K.js";import{a as w}from"./chunk-4CZQ6YQW.js";import{a as I,c as h}from"./chunk-UORIA4VW.js";import{a as T}from"./chunk-7XYHQ72T.js";import{b as y,c as H}from"./chunk-7RBRFERR.js";import{h as u,j as z}from"./chunk-7YHU2LQD.js";import{p as _}from"./chunk-EOZJRV5E.js";import{a as m,j as p,m as L}from"./chunk-HBP5N4FR.js";L();z();import{useState as k}from"react";import{ExtensionProvider as B}from"@multiversx/sdk-extension-provider";H();_();R();h();h();var ro=({callbackRoute:n,token:O,nativeAuth:c,onLoginRedirect:U})=>{let[l,d]=k(""),[A,e]=k(!1),C=c!=null,t=S(c),o=O,D=E(),f=x();function F(){return p(this,null,function*(){if(f)throw new Error(u);P(),e(!0);let s=B.getInstance();try{if(!(yield s.init())){console.warn("Something went wrong trying to redirect to wallet login..");return}let N=I(),G=encodeURIComponent(T(n!=null?n:N));if(C&&!o&&(o=yield t.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&t.setLoginToken(o);let M=m({callbackUrl:G},o&&{token:o}),{signature:a,address:i}=yield s.login(M);if(v(s),!i){e(!1),console.warn("Login cancelled."),d("Login cancelled");return}a&&o&&t.setTokenLoginInfo({signature:a,address:i}),D(y({address:i,loginMethod:"extension"})),w({callbackRoute:n,onLoginRedirect:U,options:{signature:a,address:i}})}catch(g){console.error("error logging in",g),d("error logging in"+g.message)}finally{e(!1)}})}let r=Boolean(l);return[F,{loginFailed:r,error:l,isLoading:A&&!r,isLoggedIn:f&&!r}]};export{ro as a};
//# sourceMappingURL=chunk-W5NTFHSS.js.map
