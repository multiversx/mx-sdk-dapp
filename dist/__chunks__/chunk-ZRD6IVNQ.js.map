{
  "version": 3,
  "sources": ["../../src/utils/transactions/transactionInfoHelpers/getScamFlag.tsx"],
  "sourcesContent": ["import * as linkify from 'linkifyjs';\nimport {\n  SuspiciousLinkType,\n  SuspiciousLinkPropsType,\n  TextWithLinksType\n} from 'types';\n\nexport const getTextWithLinks = (text: string): TextWithLinksType => {\n  const links = linkify.find(text);\n\n  // If no links are present in the text, return the text unmodified\n  if (!links.length) {\n    return {\n      textWithLinks: text,\n      hasLinks: false\n    };\n  }\n\n  let textWithLinks = text;\n\n  // Replace the previous links in text with normalized links\n  for (const link of links) {\n    const previousLink = text.substring(link.start, link.end);\n    textWithLinks = textWithLinks.replace(previousLink, link.value);\n  }\n\n  return {\n    textWithLinks,\n    hasLinks: true\n  };\n};\n\n/**\n * @description It checks if an asset contains suspicious info\n * If it contains text with links inside, it contains scam info, or it is marked as NSFW,\n * then it has suspicious info and may be a scam\n */\nexport const getScamFlag = ({\n  message,\n  scamInfo,\n  isNsfw,\n  verified,\n  messagePrefix = 'Message hidden due to suspicious content - '\n}: SuspiciousLinkPropsType): SuspiciousLinkType => {\n  if (verified) {\n    return {\n      message: '',\n      textWithLinks: '',\n      isSuspicious: false\n    };\n  }\n\n  const outputMessage = `${messagePrefix}${\n    scamInfo?.info ?? 'suspicious content'\n  }`;\n  const { textWithLinks, hasLinks } = getTextWithLinks(message);\n\n  if (hasLinks || isNsfw || scamInfo) {\n    return {\n      message: outputMessage,\n      textWithLinks,\n      isSuspicious: true\n    };\n  }\n\n  return {\n    message: '',\n    textWithLinks,\n    isSuspicious: false\n  };\n};\n"],
  "mappings": "+CAAA,+BAOa,GA8BA,EArCb,aAOO,AAAM,EAAmB,AAAC,GAAoC,CACnE,GAAM,GAAQ,AAAQ,OAAK,CAAI,EAG/B,GAAI,CAAC,EAAM,OACT,MAAO,CACL,cAAe,EACf,SAAU,EACZ,EAGF,GAAI,GAAgB,EAGpB,OAAW,KAAQ,GAAO,CACxB,GAAM,GAAe,EAAK,UAAU,EAAK,MAAO,EAAK,GAAG,EACxD,EAAgB,EAAc,QAAQ,EAAc,EAAK,KAAK,CAChE,CAEA,MAAO,CACL,gBACA,SAAU,EACZ,CACF,EAOa,EAAc,CAAC,CAC1B,UACA,WACA,SACA,WACA,gBAAgB,iDACiC,CA3CnD,MA4CE,GAAI,EACF,MAAO,CACL,QAAS,GACT,cAAe,GACf,aAAc,EAChB,EAGF,GAAM,GAAgB,GAAG,IACvB,oBAAU,OAAV,OAAkB,uBAEd,CAAE,gBAAe,YAAa,EAAiB,CAAO,EAE5D,MAAI,IAAY,GAAU,EACjB,CACL,QAAS,EACT,gBACA,aAAc,EAChB,EAGK,CACL,QAAS,GACT,gBACA,aAAc,EAChB,CACF",
  "names": []
}
