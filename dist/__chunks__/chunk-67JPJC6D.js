import{a as fe}from"./chunk-QO2VZGTA.js";import{b as ue}from"./chunk-ETEOGFFI.js";import{a as ce}from"./chunk-UQ4TKO4K.js";import{a as ve}from"./chunk-JESPSC4I.js";import{a as ke}from"./chunk-YNZZNQYQ.js";import{a as de}from"./chunk-TYVSZHXA.js";import{a as d}from"./chunk-EFGVEBF6.js";import{a as le}from"./chunk-KFSX2APT.js";import{a as c,c as ae}from"./chunk-K3GCLKZ7.js";import{c as ne,f as ie}from"./chunk-KQPPULAV.js";import{c as oe,d as a}from"./chunk-JUB6TCFX.js";import{a as pe}from"./chunk-P64EA6SQ.js";import{a as me}from"./chunk-R7VXMYQB.js";import{a as we}from"./chunk-FJ2FD4LU.js";import{a as Ae}from"./chunk-PQ4DDH3I.js";import{a as se}from"./chunk-SWRV4LUB.js";import{a as ge}from"./chunk-PAVHGJ7A.js";import{a as he}from"./chunk-RPJN7DBE.js";import{a as te}from"./chunk-U6HTR5RX.js";import{a as re}from"./chunk-FWETJ3IL.js";import{a as L,b as $e}from"./chunk-N4YFXMKQ.js";import{b as ee,e as Ze}from"./chunk-2PVUEXHG.js";import{a as q,c as B,d as J,e as K,f as Q,h as X,k as Xe}from"./chunk-HKOZWGGV.js";import{a as O,g as j,m as Qe}from"./chunk-S6FCTAUC.js";import{b as Y,i as Z,l as $,o as Ye}from"./chunk-S55DZJQR.js";import{a as Ke}from"./chunk-NJJDLNA3.js";import{c as P,d as I,g as V,j as f,k as H}from"./chunk-P6ZSBO2H.js";import{e as U,g as C,j as y}from"./chunk-L5S5P5OY.js";import{d as G}from"./chunk-4GKCTMFA.js";import{b as F,c as Je}from"./chunk-7RBRFERR.js";import{x as Be}from"./chunk-UDZUNVED.js";import{b as x,d as M,f as z}from"./chunk-XXEKL2DH.js";import{p as qe}from"./chunk-EOZJRV5E.js";import{a as h,b as k,j as n,m as R}from"./chunk-HBP5N4FR.js";R();import{useEffect as g,useRef as et}from"react";Be();Je();Qe();Xe();Ye();Ke();qe();$e();Ze();var S=!1;function Lt(){let s=a(Z),Pe=a($),D=a(J),{loginMethod:v,iframeLoginType:Ie}=a(q),Ce=a(Q),u=a(O),N=a(j),b=a(K),E=a(B),ye=a(Y),o=a(X),T=o==null?void 0:o.nativeAuthConfig,Le=ce(T||!1),{data:m,isLoading:W,error:_}=te(u),A=et(!1),t=oe(),{setLedgerProvider:Se,ledgerData:p}=ke();fe();let{callbackRoute:De,logoutRoute:Ne}=D||{callbackRoute:"",logoutRoute:""},[be]=ue({callbackRoute:De,logoutRoute:Ne});g(()=>{Ee()},[s]),g(()=>{Ge()},[u,v,ye]),g(()=>{We()},[o==null?void 0:o.nativeAuthToken,u]),g(()=>{_e()},[m,W]),g(()=>{Te()},[N,E,p]);function Ee(){return n(this,null,function*(){let r=s.chainId&&![x,M,z].includes(s.chainId)&&!s.roundDuration;if(!!(!s.chainId||r))try{let i=yield re();i&&(s.chainId!==i.erd_chain_id||s.roundDuration!==i.erd_round_duration)&&t(G({chainId:i.erd_chain_id,roundDuration:i.erd_round_duration}))}catch(i){console.error("failed refreshing chainId ",i)}})}function Te(){N==null&&b!=null&&p&&t(V({index:b.index,address:u,hasContractDataEnabled:p.dataEnabled,version:p.version}))}function We(){return n(this,null,function*(){let{remainingParams:{impersonate:r,multisig:e}}=L(["impersonate"]),i=ee(u);if(!(o!=null&&o.nativeAuthToken)||r||e||i)return;let l=se(o==null?void 0:o.nativeAuthToken);(l==null?void 0:l.address)&&l.address!==u&&(t(I(l.address)),yield de())})}function _e(){return n(this,null,function*(){if(W){t(f(!0));return}if(_){t(H("Failed getting account")),console.error("Failed getting account ",_);return}if(A.current){A.current=!1,t(f(!1));return}m?t(P(k(h({},m),{address:u,nonce:m.nonce.valueOf()}))):E||t(I("")),t(f(!1))})}function Re(){return n(this,null,function*(){let r=ne(Pe);if(c(r),Ce!=null){try{let e=yield d(),{clearNavigationHistory:i,remainingParams:{signature:l,multisig:Oe,impersonate:je}}=L(["signature","loginToken","address","multisig","impersonate"]);if(!e)return c(ie),t(U(null)),t(C(null)),i();let w=yield ve({loginToken:o==null?void 0:o.loginToken,extraInfoData:{multisig:Oe,impersonate:je},address:e,signature:l,loginService:Le});w&&(A.current=!0,t(f(!0)),t(F({address:w.address,loginMethod:"wallet"})),t(P(k(h({},w),{nonce:le(w)}))),t(f(!1))),i()}catch(e){console.error("Failed authenticating wallet user ",e)}t(C(null))}})}function xe(){return n(this,null,function*(){let r=yield d(),e=yield me(r);e&&c(e)})}function Me(){return n(this,null,function*(){let r=yield d(),e=yield he(r);e&&c(e)})}function ze(){return n(this,null,function*(){let r=yield d(),e=yield Ae(r);e&&c(e)})}function Fe(){return n(this,null,function*(){let r=yield d(),e=yield ge(r);e&&c(e)})}function Ve(){return n(this,null,function*(){let r=yield d(),e=yield pe({address:r,walletUrl:s.walletAddress});e&&c(e)})}function He(){return n(this,null,function*(){let r=yield d();if(!s.metamaskSnapWalletAddress)throw new Error("Metamask snap wallet URL is not set.");let e=yield we({address:r,walletUrl:s.metamaskSnapWalletAddress,loginType:Ie});e&&c(e)})}function Ue(){return n(this,null,function*(){try{t(y(!0)),yield be(!1)}catch(r){console.error("Could not initialize WalletConnect")}finally{t(y(!1))}})}function Ge(){return n(this,null,function*(){if(!(v==null||S))switch(v){case"ledger":{S=!0,yield Se(),S=!1;break}case"walletconnectv2":{Ue();break}case"extension":{xe();break}case"passkey":{Me();break}case"metamask":{ze();break}case"opera":{Fe();break}case"crossWindow":{Ve();break}case"iframe":He();break;case"extra":{ae();break}case"wallet":case"":{Re();break}default:return}})}return null}export{Lt as a};
//# sourceMappingURL=chunk-67JPJC6D.js.map
