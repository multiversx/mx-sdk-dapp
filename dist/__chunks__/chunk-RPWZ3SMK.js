import{a as S}from"./chunk-4MBWSVL5.js";import{a as h}from"./chunk-UQ4TKO4K.js";import{a as A}from"./chunk-XUD3HGD3.js";import{a as v}from"./chunk-K3GCLKZ7.js";import{c as k}from"./chunk-JUB6TCFX.js";import{a as b}from"./chunk-R4M6QQ4K.js";import{a as w}from"./chunk-4CZQ6YQW.js";import{a as I,c as P}from"./chunk-UORIA4VW.js";import{a as T}from"./chunk-7XYHQ72T.js";import{b as y,c as B}from"./chunk-7RBRFERR.js";import{h as L,j as R}from"./chunk-7YHU2LQD.js";import{p as H}from"./chunk-EOZJRV5E.js";import{a as f,j as g,m as u}from"./chunk-HBP5N4FR.js";u();R();import{useState as E}from"react";import{PasskeyProvider as C}from"@multiversx/sdk-passkey-provider/out";B();H();b();P();P();var so=({callbackRoute:i,token:F,nativeAuth:l,onLoginRedirect:O})=>{let[p,d]=E(""),[U,r]=E(!1),N=l!=null,s=h(l),o=F,D=k(),m=S();function G(){return g(this,null,function*(){if(m)throw new Error(L);A(),r(!0);let e=C.getInstance();try{if(!(yield e.init())){console.warn("Something went wrong trying to redirect to wallet login..");return}let _=I(),x=encodeURIComponent(T(i!=null?i:_));if(N&&!o&&(o=yield s.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&s.setLoginToken(o);let z=f({callbackUrl:x},o&&{token:o});yield e.login(z),v(e);let{signature:c,address:t}=e.account;if(!t){r(!1),console.warn("Login cancelled."),d("Login cancelled");return}c&&o&&s.setTokenLoginInfo({signature:c,address:t}),D(y({address:t,loginMethod:"passkey"})),w({callbackRoute:i,onLoginRedirect:O,options:{signature:c,address:t}})}catch(n){console.error("error logging in",n),d("Error logging in: "+n.message)}finally{r(!1)}})}let M=e=>g(void 0,null,function*(){let n=C.getInstance();return yield n.init(),yield n.createAccount({walletName:e})}),a=Boolean(p);return[G,M,{loginFailed:a,error:p,isLoading:U&&!a,isLoggedIn:m&&!a}]};export{so as a};
//# sourceMappingURL=chunk-RPWZ3SMK.js.map
