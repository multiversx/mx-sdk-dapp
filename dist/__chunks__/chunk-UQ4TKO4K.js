import{a as M}from"./chunk-ZV7QWZXL.js";import{c as S,d as p}from"./chunk-JUB6TCFX.js";import{a as v}from"./chunk-56Y4C7OL.js";import{a as P}from"./chunk-EA6JYINF.js";import{s as B}from"./chunk-7OZRG2YY.js";import{h as w}from"./chunk-HKOZWGGV.js";import{i as N}from"./chunk-S55DZJQR.js";import{a as z}from"./chunk-NJJDLNA3.js";import{e as g}from"./chunk-L5S5P5OY.js";import{a as r,b as L,j as C,k as l,m as y}from"./chunk-HBP5N4FR.js";y();import{useRef as $}from"react";import{Address as D,Message as G}from"@multiversx/sdk-core";B();z();var I=(t,i)=>{var n;return i?i===!0?t:(n=i.apiAddress)!=null?n:t:null},Y=t=>{let i=p(N),n=p(w),h=$(n==null?void 0:n.loginToken),a=I(i.apiAddress,t),s=P(r(r({},t===!0?{}:t),a?{apiAddress:a}:{})),b=Boolean(t),T=v(s),{address:f}=M(),m=S(),O=e=>{h.current=e,m(g(r(L(r({},n),{loginToken:e}),a?{nativeAuthConfig:s}:{})))},R=()=>{try{return T.initialize()}catch(e){console.error("Unable to get block. Login failed.",e);return}},k=({address:e,signature:o})=>{let u=h.current;if(!u)throw"Token not found. Call `setLoginToken` first.";if(!b){m(g({loginToken:u,signature:o}));return}let A=T.getToken({address:e,token:u,signature:o});return m(g(r({loginToken:u,signature:o,nativeAuthToken:A},a?{nativeAuthConfig:s}:{}))),A};return{configuration:s,setLoginToken:O,getNativeAuthLoginToken:R,setTokenLoginInfo:k,refreshNativeAuthTokenLogin:u=>C(void 0,[u],function*({signMessageCallback:e,nativeAuthClientConfig:o}){let d=yield v(o||s).initialize({noCache:Boolean(o)});if(h.current=d,!d)return;let x=new G({address:new D(f),data:l.Buffer.from(`${f}${d}`)}),c=yield e(x,{});if(!(c!=null&&c.signature))throw"Message not signed";return k({address:f,signature:l.Buffer.from(c.signature).toString("hex")})})}};export{Y as a};
//# sourceMappingURL=chunk-UQ4TKO4K.js.map
