import{a as O}from"./chunk-4MBWSVL5.js";import{a as v}from"./chunk-UQ4TKO4K.js";import{a as S}from"./chunk-XUD3HGD3.js";import{a as h}from"./chunk-K3GCLKZ7.js";import{c as w}from"./chunk-JUB6TCFX.js";import{a as B}from"./chunk-R4M6QQ4K.js";import{a as T}from"./chunk-4CZQ6YQW.js";import{a as I,c as $}from"./chunk-UORIA4VW.js";import{b as u,c as H}from"./chunk-7RBRFERR.js";import{h as L,j as z}from"./chunk-7YHU2LQD.js";import{a as y,b as R}from"./chunk-OWBHRN3S.js";import{p as x}from"./chunk-EOZJRV5E.js";import{a as f,j as m,m as d}from"./chunk-HBP5N4FR.js";d();z();import{useState as k}from"react";import{OperaProvider as W}from"@multiversx/sdk-opera-provider";H();x();B();$();R();var ao=({callbackRoute:n,token:E,nativeAuth:c,onLoginRedirect:P})=>{let[l,U]=k(""),[A,r]=k(!1),C=c!=null,t=v(c),o=E,D=w(),p=O();function F(){return m(this,null,function*(){if(p)throw new Error(L);S(),r(!0);let e=W.getInstance();try{if(!(yield e.init())){console.warn("Something went wrong trying to redirect to wallet login..");return}let{origin:N}=y(),G=I(),M=encodeURIComponent(`${N}${n!=null?n:G}`);if(C&&!o&&(o=yield t.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&t.setLoginToken(o);let _=f({callbackUrl:M},o&&{token:o});yield e.login(_),h(e);let{signature:g,address:i}=e.account;if(!i){r(!1),console.warn("Login cancelled.");return}g&&o&&t.setTokenLoginInfo({signature:g,address:i}),D(u({address:i,loginMethod:"opera"})),T({callbackRoute:n,onLoginRedirect:P,options:{signature:g,address:i}})}catch(a){console.error("error loging in",a),U("error logging in"+a.message)}finally{r(!1)}})}let s=Boolean(l);return[F,{loginFailed:s,error:l,isLoading:A&&!s,isLoggedIn:p&&!s}]};export{ao as a};
//# sourceMappingURL=chunk-V5MFDKRD.js.map
